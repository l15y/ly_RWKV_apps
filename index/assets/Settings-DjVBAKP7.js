import{h as e,r as l,i as a,u as t,j as i,o as u,c as n,a as s,w as d,b as o,d as r,k as c,l as m,m as v,n as p,p as f,q as b,f as _,t as y,s as V,v as h,x as g,g as x,y as k,V as w,z as B,A as N,B as q,C as A,D as F,E as P,_ as z}from"./index-BdOslMqv.js";const S={class:"pa-5"},T=z(e({__name:"Settings",setup(e){const z=l(0),T=l("None"),U=l(0),C=l(128),I=l(16),W=l(""),L=l(""),j=l(""),R=l([]),D=l(["Cpu","Gpu"]),J=l([]),K=l([]),O=l([]),Q=l([]),$=l([]),E=l([]),G=l([]),M=l(""),H=l("Fp16"),X=l(0),Y=l("Cpu"),Z=l(!1),ee=l([]),le=l(!1),ae=l(31),te=l({quant:0,quant_type:"",Vesion:"",Params:"",modelname:""});function ie(){window.Ai00Api.models_info((e=>{let l=e.reload.model_path.split("/").pop().split("\\").pop().split(".")[0];te.value.modelname=l,te.value.quant=e.reload.quant,te.value.quant_type=e.reload.quant_type,te.value.Vesion=e.model.version;let a=e.reload.model_path;a.includes("-1B")||a.includes("-1b")?te.value.Params="1B":a.includes("-3B")||a.includes("-3b")?te.value.Params="3B":a.includes("-7B")||a.includes("-7b")?te.value.Params="7B":a.includes("-14B")||a.includes("-14b")?te.value.Params="14B":te.value.Params="unkown"}))}window.Ai00Api.models_list((e=>{ee.value=e})),ie(),a(ee,(e=>{let l=e.map((e=>e.name)),a=l.filter((e=>e.endsWith(".st")||e.endsWith(".prefab"))),t=l.filter((e=>e.endsWith(".state"))),i=l.filter((e=>e.endsWith(".lora")));J.value=a,W.value=a[0],K.value=t,L.value=t[0],$.value=i,j.value=i[0]}));const ue=l("unkown");async function ne(){le.value=!0;let e={model_path:te.value.modelname+"-"+te.value.quant_type+"_"+te.value.quant+"-"+(new Date).getTime()+".prefab"};await window.Ai00Api.models_save(e,(async e=>{le.value=!1}))}function se(){le.value=!0;const e={Manual:X.value},l={model_path:W.value,adapter:e,quant_type:T.value,quant:Number(z.value),turbo:!0,token_chunk_size:Number(C.value),max_batch:Number(I.value),tokenizer_path:"assets/tokenizer/rwkv_vocab_v20230424.json",embed_device:Y.value,precision:H.value,lora:G.value,state:Q.value};window.Ai00Api.models_load(l,(e=>{le.value=!1,ie()}))}a(W,(e=>{let l=ee.value.find((l=>l.name===e));l&&l.info&&(ae.value=l.info.num_layer-1),e.includes("1B")||e.includes("1b")||e.includes("1.5b")||e.includes("1.5B")?ue.value="1B":e.includes("3B")||e.includes("3b")?ue.value="3B":e.includes("7B")||e.includes("7b")?ue.value="7B":e.includes("14B")||e.includes("14b")?ue.value="14B":ue.value="unkown";let a=ee.value.map((e=>e.name)),t=a.filter((e=>e.includes(ue.value)&&e.endsWith(".state"))),i=a.filter((e=>e.includes(ue.value)&&e.endsWith(".lora")));K.value=t,L.value=t[0],O.value=[],$.value=i,j.value=i[0],E.value=[],e.endsWith(".prefab")?Z.value=!0:Z.value=!1})),window.Ai00Api.adapters((e=>{R.value=e.filter((e=>e.includes("Vulkan"))),M.value=R.value[0]})),a(M,(e=>{X.value=R.value.findIndex((l=>l===e))})),a(T,(e=>{z.value="None"==e?0:U.value})),a(z,(e=>{"None"!=T.value?U.value=e:U.value=0})),a(O,(e=>{Q.value=e.map((e=>({path:e})))})),a(E,(e=>{G.value=e.map((e=>({alpha:192,path:e})))}));const de=l(!1);function oe(e){de.value=!0}function re(e){de.value=!1}const{t:ce}=t();return(e,l)=>{const a=i("perfect-scrollbar");return u(),n("div",S,[s(w,{class:"flex-0",dense:""},{default:d((()=>[s(o,{cols:"12",md:"6",xl:"6",xxl:"6"},{default:d((()=>[s(r,{class:"cardl",title:c(ce)("dashboard.title1"),"prepend-icon":"mdi-file-cabinet"},{text:d((()=>[s(a,{ref:"target",id:"card1-area",class:"card1-area"},{default:d((()=>[s(m,{modelValue:c(W),"onUpdate:modelValue":l[0]||(l[0]=e=>v(W)?W.value=e:null),color:"primary",label:c(ce)("settings.subtitle1"),items:c(J),variant:"outlined"},null,8,["modelValue","label","items"]),s(m,{modelValue:c(M),"onUpdate:modelValue":l[1]||(l[1]=e=>v(M)?M.value=e:null),color:"primary",label:c(ce)("settings.subtitle2"),items:c(R),variant:"outlined"},null,8,["modelValue","label","items"]),s(r,{class:"setcard",variant:"outlined",title:"precision",subtitle:"Precision for intermediate tensors ( Fp16[faster] or Fp32[slower but better] ). "},{text:d((()=>[s(p,{modelValue:c(H),"onUpdate:modelValue":l[2]||(l[2]=e=>v(H)?H.value=e:null),inline:""},{default:d((()=>[s(f,{label:"Fp16",value:"Fp16",color:"primary"}),s(f,{label:"Fp32",value:"Fp32",color:"primary"})])),_:1},8,["modelValue"])])),_:1}),s(r,{class:"setcard",variant:"outlined",title:"quant",subtitle:"Quantization mode. This could be FP16 or INT8 or NF4.",disabled:c(Z)},{text:d((()=>[s(p,{modelValue:c(T),"onUpdate:modelValue":l[3]||(l[3]=e=>v(T)?T.value=e:null),inline:""},{default:d((()=>[s(f,{label:"FP16",value:"None",color:"primary"}),s(f,{label:"INT8",value:"Int8",color:"primary"}),s(f,{label:"NF4",value:"NF4",color:"primary"})])),_:1},8,["modelValue"]),s(b,{modelValue:c(z),"onUpdate:modelValue":l[4]||(l[4]=e=>v(z)?z.value=e:null),color:"primary",min:0,max:c(ae),step:1,"thumb-label":"always",disabled:"None"==c(T)},null,8,["modelValue","max","disabled"])])),_:1},8,["disabled"]),s(r,{class:"setcard",variant:"outlined",title:"token_chunk_size",subtitle:"Size of token chunk. This could be 32 or 64 or 128 (faster)."},{text:d((()=>[s(p,{modelValue:c(C),"onUpdate:modelValue":l[5]||(l[5]=e=>v(C)?C.value=e:null),inline:""},{default:d((()=>[s(f,{label:"32",value:32,color:"primary"}),s(f,{label:"64",value:64,color:"primary"}),s(f,{label:"128",value:128,color:"primary"})])),_:1},8,["modelValue"])])),_:1}),s(r,{class:"setcard",variant:"outlined",title:"embed_device",subtitle:"The embedding device."},{text:d((()=>[s(m,{modelValue:c(Y),"onUpdate:modelValue":l[6]||(l[6]=e=>v(Y)?Y.value=e:null),color:"primary",label:c(ce)("settings.subtitle2"),items:c(D),variant:"outlined"},null,8,["modelValue","label","items"])])),_:1})])),_:1},512)])),title:d((()=>[_(y(e.$t("settings.title1"))+" ",1),s(V),s(h,{color:"primary","prepend-icon":"mdi-fire",variant:"outlined",onClick:se},{default:d((()=>[_(y(e.$t("settings.button2")),1)])),_:1}),s(g,{modelValue:c(le),"onUpdate:modelValue":l[7]||(l[7]=e=>v(le)?le.value=e:null),scrim:!0,persistent:"",width:"auto"},{default:d((()=>[s(r,{color:"primary"},{default:d((()=>[s(x,null,{default:d((()=>[_(" Please stand by "),s(k,{indeterminate:"",color:"white",class:"mb-0"})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["title"])])),_:1}),s(o,{cols:"6"},{default:d((()=>[s(w,{class:"flex-0",dense:""},{default:d((()=>[s(o,{cols:"12"},{default:d((()=>[s(r,{class:"cardr",title:"State-Tuned & LoRA","prepend-icon":"mdi-vector-link"},{text:d((()=>[s(a,{ref:"target",id:"card1-area",class:"card1-area"},{default:d((()=>[s(r,{class:"setcard",variant:"outlined",title:"Intial State",subtitle:"The file extension must be .state"},{text:d((()=>[s(B,{modelValue:c(O),"onUpdate:modelValue":l[8]||(l[8]=e=>v(O)?O.value=e:null),items:c(K),label:"Select state-tuned model",multiple:"",variant:"outlined",clearable:""},{selection:d((e=>[(u(),N(F,A({key:JSON.stringify(e.item)},e.attrs,{disabled:e.disabled,"model-value":e.selected,size:"small","onClick:close":l=>e.parent.selectItem(e.item)}),{prepend:d((()=>[s(q,{class:"bg-accent text-uppercase",start:""},{default:d((()=>[_(y(e.item.title.slice(0,1)),1)])),_:2},1024)])),default:d((()=>[_(" "+y(e.item.title),1)])),_:2},1040,["disabled","model-value","onClick:close"]))])),_:1},8,["modelValue","items"])])),_:1}),s(V),s(r,{class:"setcard",variant:"outlined",title:"LoRA",subtitle:"The file extension must be .lora"},{text:d((()=>[s(B,{modelValue:c(E),"onUpdate:modelValue":l[9]||(l[9]=e=>v(E)?E.value=e:null),items:c($),label:"Select LoRA model",multiple:"",variant:"outlined",onKeydown:oe,onKeyup:re,disabled:c(de)},{selection:d((e=>[(u(),N(F,A({key:JSON.stringify(e.item)},e.attrs,{disabled:e.disabled,"model-value":e.selected,size:"small","onClick:close":l=>e.parent.selectItem(e.item)}),{prepend:d((()=>[s(q,{class:"bg-accent text-uppercase",start:""},{default:d((()=>[_(y(e.item.title.slice(0,1)),1)])),_:2},1024)])),default:d((()=>[_(" "+y(e.item.title),1)])),_:2},1040,["disabled","model-value","onClick:close"]))])),_:1},8,["modelValue","items","disabled"])])),_:1})])),_:1},512)])),default:d((()=>[s(P)])),_:1})])),_:1}),s(o,{cols:"12"},{default:d((()=>[s(r,{class:"cardr",title:"Save quantized model as prefab","prepend-icon":"mdi-content-save-move-outline"},{text:d((()=>[s(r,{class:"setcard",variant:"outlined",title:"Loaded model info",subtitle:"The file extension must be .lora"},{text:d((()=>[s(w,{align:"center"},{default:d((()=>[s(o,{cols:"2",align:"center"},{default:d((()=>[s(F,{color:"primary",label:""},{default:d((()=>[_(" Name ")])),_:1})])),_:1}),s(o,{cols:"4",align:"left"},{default:d((()=>[_(y(c(te).modelname),1)])),_:1}),s(o,{cols:"2",align:"center"},{default:d((()=>[s(F,{color:"primary",label:""},{default:d((()=>[_(" Params ")])),_:1})])),_:1}),s(o,{cols:"4",align:"left"},{default:d((()=>[_(y(c(te).Params),1)])),_:1})])),_:1}),s(w,{align:"center"},{default:d((()=>[s(o,{cols:"2",align:"center"},{default:d((()=>[s(F,{color:"primary",label:""},{default:d((()=>[_(" Vesion ")])),_:1})])),_:1}),s(o,{cols:"4",align:"left"},{default:d((()=>[_(y(c(te).Vesion),1)])),_:1}),s(o,{cols:"2",align:"center"},{default:d((()=>[s(F,{color:"primary",label:""},{default:d((()=>[_(" Quant ")])),_:1})])),_:1}),s(o,{cols:"4",align:"left"},{default:d((()=>[_(y(c(te).quant_type)+"_"+y(c(te).quant),1)])),_:1})])),_:1})])),default:d((()=>[s(P,null,{default:d((()=>[s(w,{align:"center"},{default:d((()=>[s(o,{cols:"4",align:"center"}),s(o,{cols:"4",align:"center"},{default:d((()=>[s(h,{color:"primary","prepend-icon":"mdi-fire",variant:"outlined",onClick:ne},{default:d((()=>[_(" Save as prefab ")])),_:1})])),_:1}),s(o,{cols:"4",align:"center"})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-f8838336"]]);export{T as default};
